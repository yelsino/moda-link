---
import Header from "@components/Header.astro";
import Footer from "@components/Footer.astro";
import Card from "@components/Card.astro";
import { type Product } from "@libs/interfaces";
import Filter from "@components/islands/Filter.svelte";
import Layout from "@layouts/Layout.astro";

  export function getStaticPaths() {
  return [
    {params: {category: 'accesorios'}},
    {params: {category: 'camiseta'}},
    {params: {category: 'pantalon'}},
    {params: {category: 'gorros'}},
    {params: {category: 'zapatos'}},
  ];
}

const { category } = Astro.params

const urlBase = "https://moda-link-api.deno.dev/api/v1/products?"
const params = new URLSearchParams();
// params.set("page","1");
// params.set("sizePage", "500");
params.set("genero", "hombre");
params.set("filter", category);

const response = await fetch(urlBase+params);
const products: Product[]= await response.json();
const {searchParams} = Astro.url;
---

<Layout title="Moda Link">
  <h1>categoria ropa</h1>
  <div class="h-full">
    <Header />
    <main class="mt-20 flex">
      <Filter client:visible actualParam={searchParams} genero="hombre" />
      <section
        class="flex flex-wrap place-content-center mx-auto gap-3 sm:gap-10 items-center  py-10"
      >
        {
          products.map((product) => (
          <Card
              description={product.descripcion}
              image={product.imagen}
              link={product.url}
              marca={product.marca}
              genero={product.genero}
              likes={product.likes}
              urlAfiliado={product.urlAfiliado}
              precio={product.precio}
              categoria={product.categoria}
              subCategoria={product.subCategoria}
            />
          ))
        }
      </section>
    </main>
    <Footer />
  </div>
</Layout>
