---
import Layout from "../layouts/Layout.astro";
import Header from "@components/Header.astro";
import Footer from "@components/Footer.astro";
import Card from "@components/Card.astro";
import { type Product } from "@libs/interfaces";
import Filter from "@components/Filter.astro";

const response = await fetch("https://moda-link-api.deno.dev/api/v1/generate-data");

const data: Product[] = await response.json();

function sortByLikesDescending(a: Product, b: Product): number {
  const likesA = Number(a.likes);
  const likesB = Number(b.likes);

  return likesB - likesA; // Orden descendente por número de likes
}

const orderData = data.sort(sortByLikesDescending);

---

<Layout title="Moda Link">
  <div class="h-full">
    <Header />
    <main class="mt-20 flex">
      <!-- este es el filter. debe ocultarse minimamente si se sacó el mause de encima -->
     <!-- <Filter /> -->

      <section
        class="flex flex-wrap place-content-center mx-auto gap-3 sm:gap-10 items-center"
      >
        {
          orderData.map((product) => {
            if(product.SKU ==="SKUE88590") return null
            return  <Card
              description={product["Product title"]}
              image={product["Product main image"]}
              link={product["Promotion Link"]}
            />
          })
        }
      </section>
    </main>
    <Footer />
  </div>
</Layout>
